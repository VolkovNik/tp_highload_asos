# Проектирование высоконагруженных систем. ASOS (технопарк, 2021)
## Расчетно-пояснительная записка
## 1. Тема и целевая аудитория
ASOS -  один из самых успешных онлайн-магазинов модной одежды в отрасли. Веб-сайт продает более 850 брендов, а также свой собственный ассортимент одежды и аксессуаров.
___
### MVP
Ключевой функционал сервиса:
* Авторизация/Регистрация
* Возможность просматривать ленту товаров
* Возможность просматривать страницу товара
* Добавление товара в избранное
* Добавление товаров в корзину
* Поиск (по названию товару и по категории)
* Сортировка товаров по категориям и по цене
---
### Целевая аудитория
В сентября 2021 года месячная примерная посещаемость составила 63 800 000 посетилей. Дневная посещаемость равняется примерно 2 340 000 посетителей [1].
При этом посетителей с мобильных устройств примерно 54,1%, а с десктопных 45,9% [2].

Целевая аудитория находится в Европе, так как ASOS является британским онлайн-магазином.
Компания в основном ориентирована на молодежь.
Так в 2018 году примерно 35% пользователей - женщины возрастом от 18 до 34, 20% - женщины от 35 до 49 и 15% - мужчины от 18 до 34 [3].

#### Распределение целевой аудитории по странам (август 2021) [2]
| Страна | Все устройства | Десктоп | Мобильные |
|:-------|:---------------|:--------|:----------|
|Великобритания 28.65% | 18.9M | 40.8% | 59.2% |
| США 16.73% | 11.1M | 61.85% | 38.15% |
| Германия 6.32% | 4.2M | 48.46% | 51.54% |
| Франция 5.45% | 3.6M | 52.84% | 47.16% | 
| Австралия 5.4% | 3.6M | 47.37% | 52.63% | 

## 2. Расчет нагрузки
### Продуктовые метрики

#### Аудитория
* Месячная аудитория - 63 800 000 посетилей
* Дневная аудитория - 2 340 000 посетителей
---
#### Средний размер хранилища пользователя
* Профиль пользователя (~468 байт)
  * Имя - средняя длина 6 символов [4] => 6 байт
  * Фамилия - средняя длина 6 символов [4] => 6 байт
  * Электронный адрес - средняя длина 25 символов [5] => 25 байт
  * Год рождения - 10 символов => 10 байт
  * Адрес - 50 байт
  * Способы оплаты - 120 байт
  * Пол - 1 байт
  * Метаданные - 250 байт
* Корзина пользователя (~2448,6 байт)
  * Среднее количество товаров в корзине - 3.18 [6]
    * Фото товара - 700 байт
    * Описание товара - в среднем 66 символов => 66 байт
    * Цена товара - в среденем 14 символов => 14 байт
* Избранное пользователя (~87,75 кбайт)
  * В среднем пользователь интернет-магазинов просматривает 32 страницы с товарами [7]. На ASOS на странице 72 товара. Пусть пользователь добавляет каждую 20 вещь в избранное => в избранном ~ 115,2 товаров
  * Средний вес товара из рассчетов выше - 780 байт
___
#### Среднее количество действий пользователя по типам в день
* Авторизация - 1 раз в день
* Просмотр ленты - в среднем пользователь интернет-магазинов просматривает 32 страницы с товарами [7]. На ASOS на странице 72 товара => 2304 товара в ленте
* Просмотр одного товара - пусть пользователь просматривает каждую 12 вещь => 2304 / 12 => 192 индивидуальных просмотров товара
* Добавление в избранное - 2304 / 20 = 115,2 (описано выше)
* Добавление в корзину - среднее количество товаров в корзине - 3.18
* Фильтр - обычно пользователь сортирует товары по цене, а потом сортирует по категории
* Поиск - в среднем пользователь обращается к поиску два раза (основной запрос и уточняющий)

|  Авторизация | Просмотр товаров в ленте | Просмотр товара на странице | Добавление в избранное | Добавление в корзину | Фильтрация | Поиск |
|:-------------|:-------------------------|:----------------------------|:-----------------------|:---------------------|:-----------|:------|
|1|2304|192| 115,2|3,18|2| 2
___
### Технические метрики 
#### Размер хранения в разбивке по типам данных (в Тб) - для существенных блоков данных
* Профиль = 63 800 000 посетилей * 468 байт / 2^40 ~ 0,027 Тбайт
* Корзина = 3,18 товаров * 23 400 000 покупателей * 780 байт / 2^40 ~ 0,0527 Тбайт
  * Активных покупателей, которые совершали покупки в течение 2020 года - 23,4 миллиона [6]
* Избранное (будем считать для всех пользователей) = 115,2 товаров в избранном * 63 800 000 посетилей * 780 байт / 2^40 ~ 5,21 Тбайт
* Товары = 850 * 1500 * 4 * 500 * 1024 * 500 / 2^40 ~ 1 187,4 Тбайт
  * 850 брендов, в среднем у каждого бредна по 1500 товаров
  * У товара 4 фотографии, каждая весит 500 Кбайт
  * Описание - 500 байт
---
#### Сетевой трафик
В основном весь трафик занимает загрузка ленты товаров.
* Загрузка ленты товаров - 32 страницы в день * 72 товара * 780 байт / 1,25e+8 ~ 0,01437696 Гбит/с
---
### RPS в разбивке по типам запросов
|  Действие пользователя | Количество RPS |
|:-----------------------|:---------------|
| Авторизация/Регистрация| 27 |
| Просмотр ленты товаров | 59 |
| Просмотр страницы товара | 5200 |
| Добавление в корзину |  86 |
| Добавление в избранное | 3120 |
| Поиск | 23 |
| Фильтрация | 54 |

Уточнение: 87% пользователей пользуются поиском [8] 




## Список источников
1) https://a.pr-cy.ru/asos.com/
2) https://ru.semrush.com/website/asos.com/
3) https://yougov.co.uk/topics/consumer/articles-reports/2018/10/10/asos-marketing-week-masters-brand-year
4) https://colors-newyork.com/how-long-is-the-average-full-name/
5) https://baymard.com/blog/form-field-usability-matching-user-expectations
6) https://www.asosplc.com/~/media/Files/A/Asos-V2/reports-and-presentations/2020-annual-report.pdf
7) https://sleeknote.com/blog/e-commerce-statistics
8) https://www.algolia.com/blog/ecommerce/e-commerce-search-and-kpis-statistics/